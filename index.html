<!DOCTYPE html>
<!-- saved from url=(0141)file:///E:/CODE/maimai-anti15webside/maimai%E3%81%A7%E3%82%89%E3%81%A3%E3%81%8F%E3%81%99NET%EF%BC%8D%E3%83%9B%E3%83%BC%E3%83%A0%EF%BC%8D.html -->
<html lang="zh"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta name="viewport" content="width=device-width,initial-scale=1.0,user-scalable=yes,shrink-to-fit=no">
	<script> 
		var baseW = 768;
		var iOSW = 0;
		var ua = navigator.userAgent.toLowerCase();
		var isiOS = (ua.indexOf("iphone") > -1) || (ua.indexOf("ipod") > -1) || (ua.indexOf("ipad") > -1);
		if(isiOS){
			iOSW = document.documentElement.clientWidth;
		}
		window.addEventListener("resize", updateMetaViewport, false);
		window.addEventListener("orientationchange", updateMetaViewport, false);
		var ev = document.createEvent("UIEvent");
		ev.initEvent("resize", true, true)
		window.dispatchEvent(ev);
		function updateMetaViewport(){
			var viewportContent;
			var w = window.outerWidth;
			if(isiOS){
				w = iOSW;
			}
			if(w < baseW){
				viewportContent = "width=480,initial-scale=" + w/480 + ",user-scalable=yes,shrink-to-fit=no";
			}else{
				viewportContent = "width=device-width,initial-scale=1.0,user-scalable=yes,shrink-to-fit=no";
			}
			document.querySelector("meta[name='viewport']").setAttribute("content", viewportContent);
		}
	</script>


	<title>maimaiでらっくす-TOOLS</title>
	<link rel="stylesheet" href="./index_files/common.css">
	</head><body><div class="wrapper t_c">
					<div class="spmenu_toggle"></div>
				<img src="./img/logo.png" class="logo p_5">
				<a href="https://anti15.gzx7301.top/setting" class="setting link-instanted" target="_self"><img src="./img/btn_setting.png"></a>	
			</div>
	<div class="wrapper main_wrapper t_c">
		<header class="f_0">
			<div class="f_0">
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 480 10" preserveAspectRatio="none" style="height:10px">
	<path d="M0,10 v-5 q5,5 10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 v5 Z" fill="#7ed3ff"></path>
</svg>
<div class="menu">
	<a href="https://anti15.gzx7301.top" class="d_ib col4 p_4"><img src="./img/menu_home_on.png" class="w_112"></a>
</div>
<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 480 10" preserveAspectRatio="none" style="height:10px">
	<path d="M0,0 v5 q5,5 10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 v-5 Z" fill="#7ed3ff"></path>
</svg>
</div>
	</header>
<div class="see_through_block m_15 m_t_10 p_10 p_r t_l f_0">
	<div class="basic_block p_10 f_0">
				<img loading="lazy" src="./img/saved_resource" class="w_112 f_l">
		<div class="p_l_10 f_l">
			<div class="trophy_block trophy_Normal p_3 t_c f_0">
				<div class="trophy_inner_block f_13">
					<div id="islogin">该设备已访问 ↓↓ 次</div>
				</div>
			</div>
			<div class="m_b_5">
				<div class="name_block f_l f_16" id="username"> </div>
				<div class="f_r t_r f_0">
					<div class="p_r p_3">
						<img src="./img/rating_base_normal.png" class="h_30 f_r">
						<div class="rating_block" id="localStorage.pagecount" >0</div>
					</div>
				</div>
				<div class="clearfix"></div>
			</div>
			<img src="./img/line_01.png" class="user_data_block_line">
			<div class="clearfix"></div>
			<img src="./img/course_rank_00T7GHJvGe.png" class="h_35 f_l">
			<img src="./img/class_rank_s_00ZqZmdpb8.png" class="p_l_10 h_35 f_l">
			<div class="p_l_10 f_l f_14"><img src="./img/icon_star.png" class="h_30 m_3 v_m"></div>
		</div>
		<div class="clearfix"></div>
	</div>
	<img loading="lazy" src="./img/bab779e7ab508427.png" class="w_120 m_t_10 f_r">
		<div id="unlock.result" class="comment_block break f_l f_12">这里是结果哟</div>
		<div class="clearfix"></div>
		<input type="text" minlength="2" id="myInput" placeholder="扫描或输入SGWCMAID...">	
	
<div class="town_block m_15 p_15">
		<button id="upload1" onclick="postData1()">
			<img src="./img/logout.png" alt="提交" class="w_120 m_15 m_t_5">
		</button>
		<button id="upload2" onclick="postData2()">
			<img src="./img/logout.png" alt="提交" class="w_120 m_15 m_t_5">
		</button>
		<button id="startButton" onclick="scanQR()">
			<img src="./img/camara.png" alt="扫码" class="w_120 m_15 m_t_5">
		</button>
		<button>
			<video id="preview" style="display: none;"></video>
		</button>
</div>

</div>


<footer class="f_0">
	<div class="footer_marquee">
		<div class="footer w_480">
			<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 480 50" preserveAspectRatio="none" style="height:50px">
				<path d="M0,0 v25 q5,5 10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 t10,0 v-25 Z" fill="#7cbc29"></path>
			</svg>
			<div class="m_15 m_t_0 f_13">
				<div class="m_5"><a href="http://otogame-net.com/agreement/" target="_blank" class="white">利用規約</a></div>
				<div class="m_5"><a href="index_files/rules2.txt" target="_blank" class="white">利用規約(追加)</a></div>
			</div>
			<img src="./img/line_02.png" class="w_430 m_b_10">
			<a href="http://sega.jp/" target="_blank"><img src="./img/logo_sega.png"></a>
			<div class="f_15 p_5">© SEGA</div>
							</div>
	</div>
</footer>
	
	
	
	
<script type="text/javascript" src="index_files\instascan.min.js"></script>

<script>
	var isClicked = false;
	var video = document.createElement("video");
	var canvasElement = document.createElement("canvas");
	var canvas = canvasElement.getContext("2d");
	
	function scanQR() {
		document.getElementById('startButton').addEventListener('click', function() {
            document.getElementById('preview').style.display = 'block';
            let scanner = new Instascan.Scanner({ video: document.getElementById('preview') });
            scanner.addListener('scan', function (content) {
                console.log(content);
                document.getElementById('myInput').value = content;
                document.getElementById('preview').style.display = 'none'; // 隐藏视频元素
                scanner.stop(); // 停止扫描
            });
            Instascan.Camera.getCameras().then(function (cameras) {
				console.print(cameras.length);
                if (cameras.length > 2) {
                    scanner.start(cameras[2]); // 使用第3个摄像头，通常是前置摄像头
                } else {
                    scanner.start(cameras[1]); // 使用第二个摄像头，通常是前置摄像头
                }
            }).catch(function (e) {
                console.error(e);
            });
        });
	}

	function postData1() {
		//这段没写对LocalStorg的适配
  		var x = document.getElementById("myInput").value;
  		if (x == null || x == "") {
   		 alert("需要输入SGWCMAID");
   		 return false;
  		}
		if (!isClicked) {
    		isClicked = true;
			document.getElementById("unlock.result").innerText = "正在发送请求"
			var inputVal = document.getElementById("myInput").value;
   			var xhr = new XMLHttpRequest();
   			xhr.open("POST", "https://api.gzx7301.top/logout", true);
			//xhr.open("POST", "http://localhost:8888/logout", true);
   			xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    		xhr.onreadystatechange = function() {
      		if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
     		    document.getElementById("unlock.result").innerText = this.responseText;
      		  }
   		 	 }
   			xhr.send("qr=" + inputVal);
    		setTimeout(function() {
     			isClicked = false;
   	 		 }, 500);  // 500毫秒后，允许再次点击
 		}
    
    }



	function postData2() {
		//这段对LocalStorg的适配
  		var x = localStorage.getItem('uid');
  		if (x == null || x == "") {
   		 alert("localStorage读取UID错误,请刷新页面或重新登入网站");
   		 return false;
  		}
		if (!isClicked) {
    		isClicked = true;
			document.getElementById("unlock.result").innerText = "正在发送请求"
			var inputVal = localStorage.getItem('uid');
   			var xhr = new XMLHttpRequest();
   			xhr.open("POST", "https://api.gzx7301.top/logoutid", true);
			//xhr.open("POST", "http://localhost:8888/logoutid", true);
   			xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded");
    		xhr.onreadystatechange = function() {
      		if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {
     		    document.getElementById("unlock.result").innerText = this.responseText;
      		  }
   		 	 }
   			xhr.send("id=" + inputVal);
    		setTimeout(function() {
     			isClicked = false;
   	 		 }, 500);  // 500毫秒后，允许再次点击
 		}
    
}

if(localStorage.pagecount)
    localStorage.pagecount = Number(localStorage.pagecount) + 1;
else
    localStorage.pagecount = 1;
document.getElementById("localStorage.pagecount").innerText = localStorage.pagecount;

// 获取 localStorage 中的 UID 和用户名
var uid = localStorage.getItem('UID');
var username = localStorage.getItem('username');
var usernameElement = document.getElementById('username');

var islogin = localStorage.getItem('islogin');
var isloginElement = document.getElementById('islogin');

var upload1 = document.getElementById("upload1");
var upload2 = document.getElementById("upload2");

usernameElement.textContent = username;

// 从LocalStorage中获取uid
var uid = localStorage.getItem('uid');

var inputElement = document.getElementById('myInput');
var qrElement = document.getElementById('startButton');
// 检查uid是否存在
if (uid === null || uid === '-1' || uid === '1' || uid === '0') {
    // 如果uid不存在或等于-1，显示输入框
	inputElement.style.display = 'block';
	upload2.style.display = 'none';
	isloginElement.textContent = "( 网站未登入 ) 该设备已访问 ↓↓ 次";

	
} else {
    // 如果uid存在且不等于-1，隐藏输入框
	inputElement.style.display = 'none';
	qrElement.style.display = 'none';
	upload1.style.display = 'none';
	isloginElement.textContent = "( 网站已登入 ) 该设备已访问 ↓↓ 次";
}

</script>

</div></body></html>